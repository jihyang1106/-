<%-include('head.ejs') %>
<link href="/static/css/main/main.css" rel="stylesheet" type="text/css">
<script src="static/script/main/main.js" type="text/javascript"></script>
<%-include('header.ejs') %>
<main>
    <!-- 로그인시 임박상품 수 노출 -->
    <div class="d_none" id="welcome_user">
      <div id="custom-target"></div>
    </div>

    <div class="container-xl mainPage_main" style="text-align:center; background-color: var(--main-yellow);">
        <div class="container-fluid mainPage_box">
            <!-- Row 캐러셀 -->
            <div class="row first_row_main">
              <div id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">

                  <div class="carousel-item">
                    <svg class="bd-placeholder-img bd-placeholder-img-lg d-block w-100" width="800" height="400" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: First slide" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#777"></rect><text x="50%" y="50%" fill="#555" dy=".3em">First slide</text></svg>
              
                  </div>
                  <div class="carousel-item">
                    <svg class="bd-placeholder-img bd-placeholder-img-lg d-block w-100" width="800" height="400" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Second slide" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#666"></rect><text x="50%" y="50%" fill="#444" dy=".3em">Second slide</text></svg>
              
                  </div>
                  <div class="carousel-item active">
                    <svg class="bd-placeholder-img bd-placeholder-img-lg d-block w-100" width="800" height="400" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Third slide" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#555"></rect><text x="50%" y="50%" fill="#333" dy=".3em">Third slide</text></svg>
              
                  </div>
                  <div class="carousel-item active">
                    <svg class="bd-placeholder-img bd-placeholder-img-lg d-block w-100" width="800" height="400" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Fourth slide" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#555"></rect><text x="50%" y="50%" fill="#333" dy=".3em">Fourth slide</text></svg>
            
                  </div>
                  <div class="carousel-item active">
                    <svg class="bd-placeholder-img bd-placeholder-img-lg d-block w-100" width="800" height="400" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Fifth slide" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#555"></rect><text x="50%" y="50%" fill="#333" dy=".3em">Fifth slide</text></svg>
          
                  </div>
                  <div class="carousel-item active">
                    <svg class="bd-placeholder-img bd-placeholder-img-lg d-block w-100" width="800" height="400" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Sixth slide" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#555"></rect><text x="50%" y="50%" fill="#333" dy=".3em">Sixth slide</text></svg>
          
                  </div>
                  <div class="carousel-item active">
                    <svg class="bd-placeholder-img bd-placeholder-img-lg d-block w-100" width="800" height="400" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Seventh slide" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#555"></rect><text x="50%" y="50%" fill="#333" dy=".3em">Seventh slide</text></svg>
          
                  </div>
                </div>
                
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                  <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
                  <span class="visually-hidden">Next</span>
                </button>
              </div>
            </div>
            <!-- 베스트 레시피 -->
            <div class="row second_row_main">
                <p style="font-size:xx-large">12월의 BEST 레시피</p>
                <div class="row">
                  <% for (var i=0 ; i < recipe.length ; i++) { %>
                    <div class="col-3 card text-bg-dark" style="padding:0; display: inline-block;">
                      <img src="<%=recipe[i].recipe_img%>" class="card-img" alt="..." >
                    </div>
                  <% } %>
                  <% for (var l=0 ; l < recipe.length ; l++) { %>
                    <div class="col-3"><%=recipe[l].recipe_title%></div>
                  <% } %>
                </div>


            </div>
            <!-- 이용가이드 -->
            <div class="row third_row_main" style="margin:100px 0 100px 0">
              <div style="font-size: xx-large; font-weight: bolder;">냉장고 집사 이용 가이드</div>
              <img src="/static/img/user_guide.png">
            </div>
        </div>
    </div>

    <script>
      // 1. 오늘 첫 로그인 시 - 오늘을 기준으로 유통기한 지난 식재료 존재하면 DB에서 삭제 & 삭제 알림 
      // 2. 당일 재로그인 시 - 알림 안 뜸 (유통기한 지난 식재료는 첫 로그인때 삭제되었기 때문에 삭제할 필요X 알림 필요X)
      // 3. 다음날 첫 로그인 시 - 유통기한 지난 식재료 존재하면 DB에서 삭제 & 알림 ... 1~2 반복
      // 4. 만약 당일 첫 로그인인데 유통기한 지난 식재료 없으면(exp_count<1) DB에서 삭제X 알림X
      //로그인 O
      if ( "<%=isLogin%>" == "true" ){ 
        // fridgeList();
        $("#welcome_user").removeClass("d_none"); //user 환영 인사말 display
        // $("#welcome_user div").html("<span>"+`${localStorage.getItem("username")}`+"님🌱</span><br>유통기한이 임박한 식재료 <b><%=fresh_count%>개</b>가 기다리고 있어요 !");
        
        console.log("<%=user_name%>","<%=exp_count%>");
        welcomeToast("<%=user_name%>","<%=fresh_count%>");
        if( "<%=exp_count%>" > 0 ){ // 삭제할 식재료 존재 & 로그인 O
          deleteAlert("<%=user_name%>","<%=exp_count%>"); // 식재료 삭제 & 알림
        }
      //   console.log(`${localStorage.getItem("username")}`,"<%=exp_count%>");
      //   welcomeToast(`${localStorage.getItem("username")}`,"<%=fresh_count%>");
      //   if( "<%=exp_count%>" > 0 ){ // 삭제할 식재료 존재 & 로그인 O
      //     deleteAlert(`${localStorage.getItem("username")}`,"<%=exp_count%>"); // 식재료 삭제 & 알림
      //   }
      }
 
    </script>


</main>

<%-include('footer.ejs') %>
